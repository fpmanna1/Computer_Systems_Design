00000000                                     1  **********
00000000                                     2  *SECONDO TRASMETTITORE
00008000                                     3  		ORG		$8000
00008000  B1 B2 B3 B4 B5 B6 B7 B8 B9 ...     4  MES		DC.B		$B1,$B2,$B3,$B4,$B5,$B6,$B7,$B8,$B9,$BA,$BB,$BC,$BD,$BE,$BF,$B1,$B2,$B3
00008012  12                                 5  DIM		DC.B		18 * 18 caratteri da un byte
00008013  01                                 6  SIZE		DC.B		1
00008014  00                                 7  CNTB		DC.B		0
00008015  00                                 8  VAR		DC.B		0
00008016                                     9  
00008016  =00002006                         10  PIADB		EQU		$2006 * Porto trasmissione PIA
00008016  =00002007                         11  PIACB		EQU		$2007
00008016                                    12  
00008016                                    13  
00008200                                    14  		ORG		$8200
00008200  4EB9 0000823A                     15  INIT		JSR		INIZIALIZZA
00008206                                    16  	
00008206  5239 00008015                     17  WAIT		ADDI.B		#1,VAR
0000820C  0C39 0004 00008015                18  		CMPI.B	#4,VAR  * Ciclo di attesa per attendere la configurazione della PIA in ricezione del nodo A
00008214  66F0                              19  		BNE		WAIT
00008216  13FC 0000 00008015                20  		MOVE.B	#0,VAR
0000821E                                    21  
0000821E  207C 00002006                     22  		MOVEA.L	#PIADB,A0
00008224                                    23  	
00008224  1010                              24  		MOVE.B	(A0),D0		*Lettura fittizia per far abbassare CB7
00008226  10B9 00008012                     25  		MOVE.B	DIM,(A0)	*invio della dimensione
0000822C                                    26  
0000822C  40C1                              27  		MOVE.W	SR,D1
0000822E  0241 D8FF                         28  		ANDI.W	#$D8FF,D1	*maschera per le interruzioni. 
00008232  46C1                              29  		MOVE.W	D1,SR
00008234                                    30  
00008234  4EF9 00008234                     31  LOOP		JMP		LOOP
0000823A                                    32  
0000823A                                    33  
0000823A                                    34  INIZIALIZZA	* Configurazione della PIA in trasmissione
0000823A  11FC 0000 2007                    35  		MOVE.B	#0,PIACB
00008240  11FC 00FF 2006                    36  		MOVE.B	#$FF,PIADB
00008246  11FC 0025 2007                    37  		MOVE.B	#%00100101,PIACB
0000824C  4E75                              38  		RTS
0000824E                                    39  
0000824E                                    40  *interruzione livello	4 mappato a $70
0000824E                                    41  
00008900                                    42  		ORG		$8900
00008900                                    43  
00008900  2F08                              44  INT4		MOVE.L	A0,-(A7)
00008902  2F09                              45  		MOVE.L	A1,-(A7)
00008904  2F00                              46  		MOVE.L	D0,-(A7)
00008906  2F01                              47  		MOVE.L	D1,-(A7)
00008908  2F02                              48  		MOVE.L	D2,-(A7)
0000890A                                    49  
0000890A  4240                              50  		CLR		D0
0000890C  4241                              51  		CLR		D1
0000890E  4242                              52  		CLR		D2
00008910  207C 00002006                     53  		MOVEA.L	#PIADB,A0
00008916  227C 00008000                     54  		MOVEA.L	#MES,A1
0000891C  1039 00008013                     55  		MOVE.B	SIZE,D0
00008922  1239 00008014                     56  		MOVE.B	CNTB,D1 	* contatore caratteri inviati
00008928                                    57  	
00008928                                    58  		*Lettura fittizia
00008928  1410                              59  		MOVE.B	(A0),D2		*Cosi posso riusare D2
0000892A                                    60  	
0000892A                                    61  	
0000892A  1439 00008012                     62  		MOVE.B	DIM,D2
00008930  C4C0                              63  		MULU		D0,D2		*Dimensione totale dei byte da inviare, numero byte del singolo carattere * numero di caratteri da inviare
00008932                                    64  
00008932  B401                              65  		CMP.B		D1,D2		*un controllo su D2 per capire quando finisce la trasmissione 
00008934  6700 0014                         66  		BEQ		RIPRISTINO
00008938                                    67  
00008938  D2C1                              68  		ADDA		D1,A1		* mi sposto sul prossimo carattere da inviare
0000893A  1091                              69  		MOVE.B	(A1),(A0)	* scrittura nel registro dati della PIA
0000893C  5201                              70  		ADD.B		#1,D1		* incremento il numero di caratteri inviati
0000893E  B401                              71  		CMP.B		D1,D2
00008940  6600 0002                         72  		BNE		FUORI
00008944                                    73  	
00008944                                    74  
00008944                                    75  FUORI	
00008944  13C1 00008014                     76  		MOVE.B	D1,CNTB
0000894A                                    77  RIPRISTINO
0000894A  241F                              78  		MOVE.L	(A7)+,D2
0000894C  221F                              79  		MOVE.L	(A7)+,D1
0000894E  201F                              80  		MOVE.L	(A7)+,D0
00008950  225F                              81  		MOVE.L	(A7)+,A1
00008952  205F                              82  		MOVE.L	(A7)+,A0
00008954                                    83  	
00008954  4E73                              84  		RTE
00008956                                    85  		END		INIT

No errors detected
No warnings generated
